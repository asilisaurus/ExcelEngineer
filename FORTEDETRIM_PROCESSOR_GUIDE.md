# FORTEDETRIM ORM PROCESSOR - Гибкий скрипт для ежемесячной обработки

## Описание задачи
Создание качественного гибкого скрипта для ежемесячной обработки данных ORM мониторинга продукта Fortedetrim.

## Эталонные данные
- Результаты февраль-май: https://docs.google.com/spreadsheets/d/1pxUF5HnII7hVnaw077mE0FHqGp-TN1Rk/edit
- Исходные данные: https://docs.google.com/spreadsheets/d/1RT8T5gnDPe0KMikTmVNdSvxqDal3aQUmelpEwItgxMI/edit

## Структура обработки

### 1. Входные данные
- Площадка
- Ссылка на сообщение  
- Текст сообщения
- Дата
- Ник/Автор
- Просмотры
- Вовлечение

### 2. Выходные данные
- Площадка
- Текст
- Дата
- Ник
- Просмотры
- Вовлечение

### 3. Категоризация
- Отзывы: содержат 'отзыв', 'рекомендую', 'покупал'
- Комментарии: содержат 'комментарий', 'вопрос', 'спрашива'
- Активные обсуждения: остальные

## Использование

### Google Apps Script (Рекомендуется)
1. Откройте Google Sheets с данными
2. Extensions > Apps Script
3. Вставьте код из файла google-sheets-fortedetrim-processor.js
4. Сохраните и обновите таблицу
5. Используйте меню 'Fortedetrim ORM' > 'Создать отчет'

### Через API
```bash
curl -X POST http://localhost:3000/api/upload \
  -F "file=@данные.xlsx" \
  -F "selectedSheet=Июнь25"
```

## Контроль качества

### Критерии оценки:
- Площадка: минимум 3 символа
- Текст: минимум 20 символов  
- Ссылка: содержит http
- Дата: формат дд.мм.гггг

### Оценки качества:
- 95-100%: Отличное качество
- 85-94%: Высокое качество
- 70-84%: Хорошее качество
- 50-69%: Удовлетворительное
- <50%: Требует улучшения

## Рекомендации

1. **Подготовка данных**:
   - Заполните все обязательные поля
   - Используйте единый формат дат
   - Проверьте корректность ссылок

2. **Именование листов**:
   - Используйте понятные имена (Июнь25)
   - Размещайте заголовки в первых строках
   - Избегайте пустых строк

3. **Ежемесячная обработка**:
   - Создавайте новый лист для каждого месяца
   - Проверяйте качество данных
   - Сохраняйте результаты в стандартном формате

## Следующие шаги

Для обработки данных за июнь 2025:
1. Подготовьте лист "Июнь25" с исходными данными
2. Запустите скрипт обработки
3. Проверьте качество результатов
4. Экспортируйте финальный отчет

Скрипт готов к использованию!
