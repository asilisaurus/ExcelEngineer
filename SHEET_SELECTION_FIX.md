# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –≤—ã–±–æ—Ä–∞ –ª–∏—Å—Ç–∞

## üö® **–ü—Ä–æ–±–ª–µ–º–∞**

–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –º–µ—Å—è—Ü–∞ –∏ –≤—ã–±–æ—Ä–æ–º –ª–∏—Å—Ç–∞:

1. **detectMonthIntelligently** –Ω–∞—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç —Å –º–µ—Å—è—Ü–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò—é–Ω—å25")
2. **findDataSheet** –≤—ã–±–∏—Ä–∞–µ—Ç –ª–∏—Å—Ç —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê–ø—Ä24")
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —Ñ–∞–π–ª –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "–ò—é–Ω—å_2025", –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –∞–ø—Ä–µ–ª—å

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ª–∏—Å—Ç–∞

```typescript
private findDataSheet(workbook: XLSX.WorkBook, monthInfo: MonthInfo, selectedSheet?: string): XLSX.WorkSheet {
  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 0: –ï—Å–ª–∏ —è–≤–Ω–æ –≤—ã–±—Ä–∞–Ω –ª–∏—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
  if (selectedSheet && sheetNames.includes(selectedSheet)) {
    console.log(`üéØ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ª–∏—Å—Ç: ${selectedSheet}`);
    return workbook.Sheets[selectedSheet];
  }
  
  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º –º–µ—Å—è—Ü–µ–º
  const monthPatterns = [
    monthInfo.name.toLowerCase(),
    monthInfo.shortName.toLowerCase(),
    monthInfo.name.toLowerCase() + '25',
    monthInfo.shortName.toLowerCase() + '25'
  ];
  
  // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –ª–∏—Å—Ç—ã —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –º–µ—Å—è—Ü–µ–º
  // –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤—ã–±–∏—Ä–∞–µ–º –ª–∏—Å—Ç —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ª–∏—Å—Ç–æ–≤

```typescript
// POST /api/get-sheets
app.post("/api/get-sheets", (req, res) => {
  // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ª–∏—Å—Ç–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
  // - name: –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞
  // - rowCount: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
  // - hasData: –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
});
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞

```typescript
async processExcelFile(
  input: string | Buffer, 
  fileName?: string,
  selectedSheet?: string  // –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
): Promise<{ outputPath: string; statistics: ProcessingStats }>
```

## üìã **–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ª–∏—Å—Ç–∞ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)**

1. **–í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ª–∏—Å—Ç** (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)
2. **–õ–∏—Å—Ç —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –º–µ—Å—è—Ü–µ–º** (–ø–æ —à–∞–±–ª–æ–Ω–∞–º)
3. **–õ–∏—Å—Ç —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—Ä–æ–∫** (fallback)

## üîÑ **–®–∞–±–ª–æ–Ω—ã –ø–æ–∏—Å–∫–∞ –º–µ—Å—è—Ü–∞**

```typescript
const monthPatterns = [
  monthInfo.name.toLowerCase(),     // "–∏—é–Ω—å"
  monthInfo.shortName.toLowerCase(), // "–∏—é–Ω"
  monthInfo.name.toLowerCase() + '25', // "–∏—é–Ω—å25"
  monthInfo.shortName.toLowerCase() + '25', // "–∏—é–Ω25"
  monthInfo.name.toLowerCase() + '24', // "–∏—é–Ω—å24"
  monthInfo.shortName.toLowerCase() + '24'  // "–∏—é–Ω24"
];
```

## üìä **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–±–æ—Ä–∞ –ª–∏—Å—Ç–∞:

```
üìã –ù–∞–π–¥–µ–Ω—ã –ª–∏—Å—Ç—ã: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –ò—é–Ω—å25, –ú–∞–π25, –ê–ø—Ä25, –ú–∞—Ä—Ç25...
üéØ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ª–∏—Å—Ç: –ò—é–Ω—å25
üìÖ –ù–∞–π–¥–µ–Ω –ª–∏—Å—Ç —Å —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –º–µ—Å—è—Ü–µ–º: –ò—é–Ω—å25 (156 —Å—Ç—Ä–æ–∫)
üìã –í—ã–±—Ä–∞–Ω –ª–∏—Å—Ç: –ò—é–Ω—å25 (156 —Å—Ç—Ä–æ–∫)
```

## üéØ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ—Å—è—Ü–∞ –∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –ª–∏—Å—Ç–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –Ω–∞–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏