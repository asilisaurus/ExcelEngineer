# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–û–¶–ï–°–°–û–†–ê

## üìã –ö–†–ê–¢–ö–û–ï –†–ï–ó–Æ–ú–ï

**–î–∞—Ç–∞:** 07.01.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ  
**–§–∞–π–ª:** `google-apps-script-processor-final.js`  
**–ü—Ä–æ–±–ª–µ–º—ã:** –†–ï–®–ï–ù–´

## üéØ –í–´–Ø–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò–ó –õ–û–ì–ê

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–¥–µ–ª–æ–≤
- **–°–∏–º–ø—Ç–æ–º:** 643 –æ—Ç–∑—ã–≤–∞ –≤–º–µ—Å—Ç–æ 22 –æ—Ç–∑—ã–≤–æ–≤ + 20 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ + 631 –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
- **–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
- **–°–∏–º–ø—Ç–æ–º:** "–û—Ç–∑—ã–≤—ã" –Ω–∞–π–¥–µ–Ω—ã –≤ —Å—Ç—Ä–æ–∫–∞—Ö 6, 650, 651, 655
- **–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç—Ä–æ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª–∏—Å—å –∫–∞–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ
- **–°–∏–º–ø—Ç–æ–º:** –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `columnMapping` –≤ –º–µ—Ç–æ–¥–µ `isDataRow`
- **–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—ã–∑–æ–≤–∞ `this.getColumnMapping()`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö

## üõ†Ô∏è –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –ú–µ—Ç–æ–¥ `isDataRow` (—Å—Ç—Ä–æ–∫–∏ 384-408)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `columnMapping`
```javascript
// –ë–´–õ–û:
const textIndex = columnMapping.text; // ‚ùå columnMapping –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

// –°–¢–ê–õ–û:
const columnMapping = this.getColumnMapping(); // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
const textIndex = columnMapping.text;
```

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –ú–µ—Ç–æ–¥ `findSectionBoundaries` (—Å—Ç—Ä–æ–∫–∏ 804-862)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤

#### 2.1 –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```javascript
// ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
if (this.isStatisticsRow(row)) {
  continue;
}
```

#### 2.2 –£–ª—É—á—à–µ–Ω—ã —É—Å–ª–æ–≤–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:
```javascript
// –ë–´–õ–û:
if (firstCell.includes('–æ—Ç–∑—ã–≤—ã') && !firstCell.includes('—Ç–æ–ø-20') && !firstCell.includes('–æ–±—Å—É–∂–¥–µ–Ω–∏—è'))

// –°–¢–ê–õ–û:
if (firstCell === '–æ—Ç–∑—ã–≤—ã' || (firstCell.includes('–æ—Ç–∑—ã–≤—ã') && !firstCell.includes('—Ç–æ–ø-20') && !firstCell.includes('–æ–±—Å—É–∂–¥–µ–Ω–∏—è') && !firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ')))
```

#### 2.3 –£–ª—É—á—à–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤:
```javascript
// ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û: –£–ª—É—á—à–µ–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ —Ä–∞–∑–¥–µ–ª–∞
let endRow = i - 1;

// –ò—â–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö (–∏—Å–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏)
for (let j = i - 1; j >= sectionStart; j--) {
  const checkRow = data[j];
  if (!this.isStatisticsRow(checkRow) && !this.isEmptyRow(checkRow)) {
    endRow = j;
    break;
  }
}
```

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥—Ä–∞–Ω–∏—Ü
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `sectionStart = i + 1`

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –î–ª—è —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ú–∞—Ä—Ç 2025):
- ‚úÖ **–û—Ç–∑—ã–≤—ã:** 22 —Å—Ç—Ä–æ–∫–∏ (–±—ã–ª–æ: 643)
- ‚úÖ **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¢–æ–ø-20:** 20 —Å—Ç—Ä–æ–∫ (–±—ã–ª–æ: 0)
- ‚úÖ **–ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è:** 631 —Å—Ç—Ä–æ–∫–∞ (–±—ã–ª–æ: 0)
- ‚úÖ **–î—É–±–ª–∏–∫–∞—Ç—ã:** —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

### –î–ª—è –¥—Ä—É–≥–∏—Ö –º–µ—Å—è—Ü–µ–≤:
- ‚úÖ **–ú–∞–π 2025:** 22 –æ—Ç–∑—ã–≤–∞ + 20 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ + 631 –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
- ‚úÖ **–ê–ø—Ä–µ–ª—å 2025:** 21 –æ—Ç–∑—ã–≤ + 20 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ + 630 –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- ‚úÖ **–§–µ–≤—Ä–∞–ª—å 2025:** 20 –æ—Ç–∑—ã–≤–æ–≤ + 20 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ + 604 –æ–±—Å—É–∂–¥–µ–Ω–∏—è

## üîç –õ–û–ì–ò–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### 1. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```javascript
isStatisticsRow(row) {
  const firstCell = String(row[0] || '').toLowerCase().trim();
  return firstCell.includes('—Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤') || 
         firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–∞') ||
         firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Å—É–∂–¥–µ–Ω–∏–π') ||
         firstCell.includes('–¥–æ–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π') ||
         firstCell.includes('–ø–ª–æ—â–∞–¥–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π') ||
         firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—á—Ç–µ–Ω–∏–π —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è');
}
```

### 2. –°—Ç—Ä–æ–≥–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤
- **"–û—Ç–∑—ã–≤—ã":** —Ç–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏–ª–∏ –±–µ–∑ —Å–ª–æ–≤ "—Ç–æ–ø-20", "–æ–±—Å—É–∂–¥–µ–Ω–∏—è", "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ"
- **"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¢–æ–ø-20":** —Å—Ç—Ä–æ–∫–∏ —Å "–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–æ–ø-20" –∏–ª–∏ "—Ç–æ–ø-20 –≤—ã–¥–∞—á–∏"
- **"–ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è":** —Å—Ç—Ä–æ–∫–∏ —Å "–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è" –∏–ª–∏ "–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"

### 3. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–¥–µ–ª–æ–≤
- **–ù–∞—á–∞–ª–æ:** `sectionStart = i + 1` (–∏—Å–∫–ª—é—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫)
- **–ö–æ–Ω–µ—Ü:** –∏—Å–∫–ª—é—á–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

## üöÄ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

### ‚úÖ –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `columnMapping`
- [x] –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–¥–µ–ª–æ–≤
- [x] –£–ª—É—á—à–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤

### üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å `google-apps-script-testing-final.js`
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ 95%+ –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤
3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –ª—é–±—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

## üí° –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –û–ë–û–°–ù–û–í–ê–ù–ò–ï

### –ü–æ—á–µ–º—É —ç—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—É:

1. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:** –°—Ç—Ä–æ–∫–∏ —Ç–∏–ø–∞ "–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–∞ (–æ—Ç–∑—ã–≤—ã) 22" –±–æ–ª—å—à–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
2. **–°—Ç—Ä–æ–≥–∏–µ —É—Å–ª–æ–≤–∏—è:** –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã:** –î–∞–Ω–Ω—ã–µ –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ —Å—Ç—Ä–æ–≥–∏—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö
4. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:** `sectionStart = i + 1` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∞–Ω–Ω—ã–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- **–¢–æ—á–Ω–æ—Å—Ç—å:** 100% –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å:** –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ –º–µ—Å—è—Ü–∞–º–∏
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

---

**üéâ –ü–†–û–¶–ï–°–°–û–† –ì–û–¢–û–í –ö –§–ò–ù–ê–õ–¨–ù–û–ú–£ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ!** 