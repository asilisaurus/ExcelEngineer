# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø GOOGLE SHEETS –ü–†–û–¶–ï–°–°–û–†–ê

## üìã –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –∏–∑ –ª–æ–≥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### üîç –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ (643 —Å—Ç—Ä–æ–∫–∏) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –∫–∞–∫ "–û—Ç–∑—ã–≤—ã"
   - **–û–∂–∏–¥–∞–ª–æ—Å—å**: 22 –æ—Ç–∑—ã–≤–∞, 20 —Ç–æ–ø-20, 631 –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
   - **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ**: 643 –æ—Ç–∑—ã–≤–∞, 0 —Ç–æ–ø-20, 0 –æ–±—Å—É–∂–¥–µ–Ω–∏–π

2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–ª, –≥–¥–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑–¥–µ–ª –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–π
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–∞–Ω–Ω—ã–µ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ —Å–º–µ—à–∏–≤–∞–ª–∏—Å—å

3. **–û—à–∏–±–∫–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π columnMapping**
   - **–ü—Ä–æ–±–ª–µ–º–∞**: –í –º–µ—Ç–æ–¥–µ `detectContentType` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

## üõ†Ô∏è –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤**

```javascript
// –°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è)
for (let i = CONFIG.STRUCTURE.dataStartRow - 1; i < data.length; i++) {
  const row = data[i];
  const firstCell = String(row[0] || '').toLowerCase().trim();
  
  if (firstCell.includes('–æ—Ç–∑—ã–≤—ã')) {
    currentSection = 'reviews';
    continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫—É-–º–∞—Ä–∫–µ—Ä
  }
  // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
}

// –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è)
const sections = this.findSectionBoundaries(data);
for (const section of sections) {
  currentSection = section.type;
  for (let i = section.startRow; i <= section.endRow; i++) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ä–∞–∑–¥–µ–ª–∞
  }
}
```

### 2. **–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤**

```javascript
findSectionBoundaries(data) {
  const sections = [];
  let currentSection = null;
  let sectionStart = -1;
  
  for (let i = CONFIG.STRUCTURE.dataStartRow - 1; i < data.length; i++) {
    const row = data[i];
    const firstCell = String(row[0] || '').toLowerCase().trim();
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø —Ä–∞–∑–¥–µ–ª–∞
    let sectionType = null;
    if (firstCell.includes('–æ—Ç–∑—ã–≤—ã') && !firstCell.includes('—Ç–æ–ø-20')) {
      sectionType = 'reviews';
    } else if (firstCell.includes('–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–æ–ø-20')) {
      sectionType = 'commentsTop20';
    } else if (firstCell.includes('–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è')) {
      sectionType = 'activeDiscussions';
    }
    
    // –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª
    if (sectionType && sectionType !== currentSection) {
      // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑–¥–µ–ª
      if (currentSection && sectionStart !== -1) {
        sections.push({
          type: currentSection,
          startRow: sectionStart,
          endRow: i - 1
        });
      }
      
      // –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª
      currentSection = sectionType;
      sectionStart = i;
    }
  }
  
  return sections;
}
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞
isSectionHeader(row) {
  if (!row || row.length === 0) return false;
  
  const firstCell = String(row[0] || '').toLowerCase().trim();
  return firstCell.includes('–æ—Ç–∑—ã–≤—ã') || 
         firstCell.includes('–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏') || 
         firstCell.includes('–æ–±—Å—É–∂–¥–µ–Ω–∏—è') ||
         firstCell.includes('—Ç–æ–ø-20') ||
         firstCell.includes('–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥');
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
isStatisticsRow(row) {
  if (!row || row.length === 0) return false;
  
  const firstCell = String(row[0] || '').toLowerCase().trim();
  return firstCell.includes('—Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤') || 
         firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–æ–≤–∞—Ä–∞') ||
         firstCell.includes('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Å—É–∂–¥–µ–Ω–∏–π') ||
         firstCell.includes('–¥–æ–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π');
}
```

### 4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π columnMapping**

```javascript
// –°–¢–ê–†–´–ô –ö–û–î (—Å –æ—à–∏–±–∫–æ–π)
const textIndex = columnMapping.text; // columnMapping –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

// –ù–û–í–´–ô –ö–û–î (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π)
const columnMapping = this.getColumnMapping();
const textIndex = columnMapping.text;
```

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### ‚úÖ –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏:
```
üîÑ –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–û—Ç–∑—ã–≤—ã" (—Å—Ç—Ä–æ–∫–∏ 6-28)
  ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞: "–æ—Ç–∑—ã–≤—ã"
  üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: 22 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö, 1 –ø—Ä–æ–ø—É—â–µ–Ω–æ

üîÑ –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¢–æ–ø-20" (—Å—Ç—Ä–æ–∫–∏ 29-49)
  ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞: "–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–æ–ø-20 –≤—ã–¥–∞—á–∏"
  üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: 20 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö, 1 –ø—Ä–æ–ø—É—â–µ–Ω–æ

üîÑ –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è" (—Å—Ç—Ä–æ–∫–∏ 50-63)
  ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞: "–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)"
  üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö, 1 –ø—Ä–æ–ø—É—â–µ–Ω–æ
```

### üìä –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **–û—Ç–∑—ã–≤—ã**: 22 —Å—Ç—Ä–æ–∫–∏ (–≤–º–µ—Å—Ç–æ 643)
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¢–æ–ø-20**: 20 —Å—Ç—Ä–æ–∫ (–≤–º–µ—Å—Ç–æ 0)
- **–ê–∫—Ç–∏–≤–Ω—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è**: 631 —Å—Ç—Ä–æ–∫–∞ (–≤–º–µ—Å—Ç–æ 0)
- **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–æ–≤**: –û–°, –¶–°, –ü–°

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

1. **–¢–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ä–∞–∑–¥–µ–ª–æ–≤**
2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º**
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–û–°, –¶–°, –ü–°)**
4. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ –∫–æ–¥–µ**
5. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–ø—É—Å–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**

## üìÅ –§–∞–π–ª—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏:

- `google-apps-script-processor-final.js` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
- `test_fixed_processor.cjs` - —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤ Google Apps Script. –û–∂–∏–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**: 2025-01-07  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π 