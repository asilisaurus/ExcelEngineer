# 🧪 **ТЕСТИРОВАНИЕ СКРИПТА НА ЛИСТЕ "МАЙ"**

## 📋 **Информация о тестировании**

**Цель:** Протестировать скрипт на реальных данных из листа "Май"  
**Эталонная таблица:** https://docs.google.com/spreadsheets/d/1pxUF5HnII7hVnaw077mE0FHqGp-TN1Rk/edit  
**Целевой лист:** "Май"  
**Скрипт:** `test_may_sheet_processor.js`

---

## 🚀 **Быстрый запуск**

### **Шаг 1: Подготовка**
1. Откройте https://script.google.com/
2. Создайте новый проект: "May Sheet Test"
3. Скопируйте код из файла `test_may_sheet_processor.js`

### **Шаг 2: Запуск тестирования**
```javascript
// Основная функция - полное тестирование
function main() {
  return testMaySheetProcessor();
}
```

### **Шаг 3: Результат**
После выполнения вы увидите:
```
🧪 Запуск тестирования скрипта на листе "Май"...
📊 Загружено X строк из листа "Май"
📋 Структура данных проанализирована
✅ Обработано Y записей
📊 Результаты проанализированы
💾 Создан файл результата: [FILE_ID]
```

---

## 🧩 **Дополнительные функции**

### **Быстрый анализ структуры**
```javascript
function quickMayAnalysis() {
  // Только анализ без обработки
}
```

### **Только обработка данных**
```javascript
function processMayDataOnly() {
  // Обработка без создания файла
}
```

---

## 📊 **Ожидаемые результаты**

### **Анализ структуры:**
- Количество строк в листе "Май"
- Найденные заголовки колонок
- Количество строк с данными
- Образцы данных с типами контента

### **Обработка данных:**
- Количество отзывов (ОС)
- Количество комментариев (ЦС)
- Количество обсуждений (ПС)
- Общий балл качества обработки

### **Результирующий файл:**
- **Лист "Обработанные данные"** - все извлеченные записи
- **Лист "Статистика"** - метрики и показатели качества

---

## 📋 **Что тестируется**

### **Функции процессора:**
- ✅ Поиск и выбор листа "Май"
- ✅ Анализ структуры данных
- ✅ Определение заголовков колонок
- ✅ Классификация типов контента (ОС/ЦС/ПС)
- ✅ Извлечение данных из "грязных" строк
- ✅ Валидация и очистка данных
- ✅ Создание отчета о качестве

### **Показатели качества:**
- **Целостность данных:** Все ли записи имеют площадку и текст
- **Классификация типов:** Найдены ли отзывы и комментарии
- **Общий балл:** Итоговая оценка качества (0-100)

---

## 🔧 **Диагностика**

### **Если лист "Май" не найден:**
```
❌ Ошибка: Лист "Май" не найден в таблице
```
**Решение:** Проверьте название листа (может быть "May", "май", "Май")

### **Если мало данных обработано:**
```
📊 Результаты анализа:
   - Всего записей: 5
   - Отзывы: 0 (0%)
   - Комментарии: 0 (0%)
```
**Решение:** Запустите `quickMayAnalysis()` для анализа структуры

### **Если низкий балл качества:**
```
📊 Отчет создан:
   - Общий балл: 30/100
```
**Решение:** Проверьте маппинг колонок и логику классификации

---

## 💡 **Советы по использованию**

### **Для отладки:**
1. Сначала запустите `quickMayAnalysis()`
2. Посмотрите на структуру данных в логах
3. Проверьте найденные заголовки
4. Затем запустите полное тестирование

### **Для понимания данных:**
- Обратите внимание на образцы данных в анализе
- Проверьте, как определяются типы контента
- Посмотрите на созданный файл результата

---

## 🎯 **Критерии успешного тестирования**

### **✅ Тест успешен, если:**
- Найден лист "Май"
- Обработано > 50% строк
- Найдены отзывы и комментарии
- Общий балл качества > 70

### **🔄 Нужна корректировка, если:**
- Лист не найден
- Обработано < 30% строк
- Не найдены типы контента
- Общий балл качества < 50

---

## 📞 **Поддержка**

### **Файлы для справки:**
- `test_may_sheet_processor.js` - Основной скрипт
- `google-apps-script-processor-real-data.js` - Общий процессор
- `REAL_DATA_TESTING_REPORT.md` - Подробная документация

### **Логи и отладка:**
- Используйте `console.log()` в Google Apps Script
- Проверяйте логи выполнения
- Сохраняйте результаты для анализа

---

## 🎉 **Готово к тестированию!**

**Скопируйте код из `test_may_sheet_processor.js` в Google Apps Script и запустите функцию `main()` для полного тестирования скрипта на листе "Май"!** 🚀

**Ожидаемый результат:** Детальный анализ данных, обработка записей и создание отчета о качестве работы процессора на реальных данных.